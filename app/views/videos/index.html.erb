<h1>動画一覧</h1>
<dl class="searchbox">
  <%= search_form_for @q do |f| %>
    <dt><%= f.search_field :title_or_content_or_user_name_cont, required: true ,placeholder: '検索するテキストを入力...' %></dt>
    <dd><%= f.submit ("検索") , class: 'search-btn'%></dd>
  <% end %>
</dl>

<br/>

<%= paginate @videos %>
<%= link_to '新しく動画を投稿する', new_video_path, class: "btn btn-primary btn-sm" %>
<%= link_to "新着順", videos_path(sort_created_at: true), class: "btn btn-outline-primary btn-sm"%>
<%= link_to "人気順", videos_path(sort_like: true), class: "btn btn-outline-primary btn-sm"%>

<table class = "table table-hover" >
  <tr>
    <th>投稿者</th>
    <th>タイトル</th>
    <th>内容</th>
    <th>ジャンル</th>
    <th>タグ</th>
    <th>いいね数</th>
    <th>コメント数</th>
  </tr>

  <% @videos.each do |video| %>
    <tr>
      <td><%= video.user.name %></td>
      <td><%= video.title %></td>
      <td><%= video.content %></td>
      <td>
        <% video.genres.each do |genre| %>
          <%= link_to genre.name, videos_path(genre_id: genre.id), class: "badge badge-primary p-1" %>
        <% end %>
      </td>
      <td><%= render 'videos/tag_list', tag_list: video.tag_list %></td>
      <td><%= video.likes_count %></td>
      <td><%= video.comments.count %></td>
      <td><%= link_to '詳細', video_path(video.id) ,class: "btn btn-outline-dark btn-sm" %></td>
      <% if current_user.try(:id) == video.user_id %>
      <td><%= link_to "編集", edit_video_path(video.id), method: :get, class: "btn btn-outline-dark btn-sm" %></td>
      <td><%= link_to '削除', video_path(video.id), method: :delete,data: { confirm: '本当に削除していいですか？'}, class: "btn btn-outline-danger btn-sm" %></td>
      <% end %>
    </tr>
  <% end %>
</table>


<div class="bg-dark">
  <% @videos.each do |video| %>
    <div class="d-flex px-2 py-3">
      <div class="card mr-2" style="width:calc(50% - .25rem)">
        <iframe width="540" height="315" src=<%= @url %> allowfullscreen></iframe>
        <div class="card-body">
        <p>ジャンル <% video.genres.each do |genre| %>
            <%= link_to genre.name, videos_path(genre_id: genre.id), class: "badge badge-primary p-1" %>
          <% end %><p>
            タグ <%= render 'videos/tag_list', tag_list: video.tag_list %>
          </p>
        </div>
      </div>
      <div class="card" style="width:calc(50% - .25rem)">
        <div class="card-body" style="text-align: center">
          <h3 class="card-title"><%= video.title %></h3><hr>
            <%= video.content %>
        </div>
      </div>
    </div>
  <% end %>
</div>
